htmx.defineExtension("preload",{onEvent:function(t,e){var n,a,r;"htmx:afterProcessNode"===t&&(n=function(t,e){if(null!=t)return t.getAttribute(e)||t.getAttribute("data-"+e)||n(t.parentElement,e)},a=function(r){function a(t){r.preloadAlways||(r.preloadState="DONE"),"true"==n(r,"preload-images")&&(document.createElement("div").innerHTML=t)}return function(){var t,e;"READY"===r.preloadState&&((t=r.getAttribute("hx-get")||r.getAttribute("data-hx-get"))?htmx.ajax("GET",t,{source:r,handler:function(t,e){a(e.xhr.responseText)}}):r.getAttribute("href")&&((e=new XMLHttpRequest).open("GET",r.getAttribute("href")),e.onload=function(){a(e.responseText)},e.send()))}},r=function(e){if(e.getAttribute("href")+e.getAttribute("hx-get")+e.getAttribute("data-hx-get")!=""&&void 0===e.preloadState){var r=n(e,"preload")||"mousedown",t=-1!==r.indexOf("always");switch(t&&(r=r.replace("always","").trim()),e.addEventListener(r,function(t){"PAUSE"===e.preloadState&&(e.preloadState="READY","mouseover"===r?window.setTimeout(a(e),100):a(e)())}),r){case"mouseover":e.addEventListener("touchstart",a(e)),e.addEventListener("mouseout",function(t){t.target===e&&"READY"===e.preloadState&&(e.preloadState="PAUSE")});break;case"mousedown":e.addEventListener("touchstart",a(e))}e.preloadState="PAUSE",e.preloadAlways=t,htmx.trigger(e,"preload:init")}},e.target.querySelectorAll("[preload]").forEach(function(t){r(t),t.querySelectorAll("a,[hx-get],[data-hx-get]").forEach(r)}))}});